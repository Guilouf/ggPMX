---
title: "How to use ggplot syntax with ggPMX"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{How to use ggplot syntax with ggPMX}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

We will create simple  ggPMX controller using the theophylline example:

```{r, warning=FALSE, message=FALSE}

library(ggPMX)
library(nlmixr)
library(ggplot2)

ctr <- theophylline()
```

Each ggPMX plot is ggplot object:

```{r, warning=FALSE, message=FALSE}
p <- ctr %>% pmx_plot_dv_ipred()
class(p)
```


We could use usual ggplot syntax to customize particular plot.

Let's look on some examples.

1. Facet

ggPMX :

```{r fig.height=5, fig.width=8, warning=FALSE, message=FALSE}
ctr %>% pmx_plot_npde_pred(strat.facet= ~SEX)
```

ggplot:

```{r fig.height=5, fig.width=8, warning=FALSE, message=FALSE}
ctr %>% pmx_plot_npde_pred()+facet_wrap(~SEX)
```

As we see in general we have the same chart, but ggPMX also automatically creates appropriate title.

2. Title

ggPMX :

```{r fig.height=5, fig.width=8, warning=FALSE, message=FALSE}
ctr %>% pmx_plot_npde_pred(labels=c(title="New title!"))
```

ggplot:

```{r fig.height=5, fig.width=8, warning=FALSE, message=FALSE}
ctr %>% pmx_plot_npde_pred()+ggtitle("New title!")
```

3. X and Y axis label 

ggPMX :

```{r fig.height=5, fig.width=8, warning=FALSE, message=FALSE}
ctr %>% pmx_plot_dv_ipred(labels=c(x="X axis", y = "Y axis"))
```

ggplot:

```{r fig.height=5, fig.width=8, warning=FALSE, message=FALSE}
ctr %>% pmx_plot_dv_ipred()+xlab("X axis") + ylab("Y axis")
```